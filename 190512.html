<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width,initial-scale=1.0" /><title>用公式制作极简甘特图</title><style>body { width: 45%; max-width: 666px; margin-left: auto; margin-right: auto } @media screen and (max-width: 960px) { body { width: 96%; margin-left: auto; margin-right: auto } } a { text-decoration: none; color: #576b95 } img { max-width: 100% }</style></head><body><h2>用公式制作极简甘特图</h2><p style="text-align: center"><img src="http://ww1.sinaimg.cn/large/006NgSLKgy1g2yxf4k3ilj306e04dt8n.jpg" /></p><p>比如要做一个甘特图——在公司的一天。</p><p>不同于常规的甘特图做法，我们用单元格中的普通文本表示进度。</p><p>表中最短的间隔是半小时，所以就用一格（■）表示半小时，有多少个半小时就用多少格。</p><p>让■重复出现n次，需要用到REPT函数。</p><blockquote><p>REPT</p><p>按照给定的次数重复显示文本。可以通过函数 REPT 来不断地重复显示某一文本字符串，对单元格进行填充。</p><p>语法</p><p>REPT(text,number_times)</p><p>Text &nbsp;&nbsp;需要重复显示的文本。</p><p>说明</p><p>如果 number_times 为 0，则 REPT 返回 &quot;&quot;（空文本）。</p><p>如果 number_times 不是整数，则将被截尾取整。</p><p>REPT 函数的结果不能大于 32,767 个字符，否则，REPT 将返回错误值 #VALUE!。&nbsp;</p></blockquote><p>不需要显示■的部分可以用空文本来掩盖</p><p>在D2单元格填入=REPT(&quot;&nbsp;&quot;,<span style="color: #C00000;">(B2-$B$2)*48</span>)&amp;REPT(&quot;■&quot;,<span style="color: #00B050;">(C2-B2)*48</span>)并向下填充。</p><p><span style="color: #C00000;">已有的进度</span>，<span style="color: #00B050;">当前阶段的进度</span>，48是用来调宽度的，因为半小时=1/48，必须乘以48才会显示一格。</p><p style="text-align: center"><img src="http://ww1.sinaimg.cn/large/006NgSLKgy1g2yxq8xolvj30bt04caa2.jpg" /></p><p>例如吃饭从12:00开始，距离9:00已过去3小时，也就是6格，那么就用12个空格来掩盖，因为2个空格和一个■宽度相当，</p><p>吃饭持续时间为半小时，用1格表示，所以D3单元格实际上是12个空格和1个■，以此类推。</p><p><br/></p><p><a href="https://soft9.github.io/" target="_blank">每日一技 合集</a></p></body></html>
